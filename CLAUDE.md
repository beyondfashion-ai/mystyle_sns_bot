# mystyle_sns_bot - Claude Code Instructions

## Language Rule (HIGHEST PRIORITY)
- **Think in English, explain in Korean**: 내부 사고/분석은 영어로, 사용자에게 작업 완료 설명은 한글로.

## Build & Install Rule (IMPORTANT)
- **빌드/설치는 사용자가 요청할 때만** 실행. 코드 수정 후 자동으로 빌드하지 않음.

## Auto-commit Rule (IMPORTANT)
- 코드 수정 작업이 완료되면 **항상 자동으로 git commit**. 사용자에게 묻지 않음.
- 빌드/설치 여부와 무관하게, 변경사항이 있으면 즉시 커밋.

## Shortcut: ㅂㅂ (IMPORTANT)
- 사용자가 "ㅂㅂ"라고 입력하면 → **빌드 + 커밋**을 한 번에 실행.
  1. `npm run build` (빌드가 설정된 경우)
  2. 변경사항이 있으면 `git commit`

## Windows 환경 주의사항
- PowerShell 환경에서 실행. 한글 인코딩 이슈 주의.
- 로그 확인 시 `Select-String` 사용 권장 (`findstr` 한글 깨짐 방지)

---

## Project Overview

mystyleKPOP SNS 자동화 봇. X(Twitter)와 Instagram에 AI 패션 K-POP 매거진 콘텐츠를 자동 게시한다.
브랜드를 "글로벌 AI 패션 K-POP 매거진"으로 포지셔닝하여 `my-style.ai` 서비스로의 유입을 목표로 한다.

## Architecture

```
src/bot.js                # 핵심 SNS 게시 로직 (postToSNS 함수)
src/aiBrainstorm.js       # Hybrid LLM 파이프라인 (Gemini→Claude 2단계)
src/editorialEvolution.js # 에디토리얼 방향 자동 진화 (4단계 시간 스케일)
src/scheduler.js          # cron 스케줄러 (SNS 초안 + 에디토리얼 진화)
src/telegram.js           # 텔레그램 봇 UI/핸들러
scripts/test.js           # 통합 테스트
docs/                     # 기획서, 전략 문서
guidelines/               # 법률, IP, K-POP 전문가 가이드라인
```

- **Runtime:** Node.js (ES Modules, `"type": "module"`)
- **AI:** Gemini 2.5 Flash (`@google/genai` - 초안/분석), Claude Sonnet (`@anthropic-ai/sdk` - 폴리싱)
- **APIs:** Twitter API v2 (`twitter-api-v2`), Instagram Graph API (REST)
- **Infra:** Firebase Storage (이미지 호스팅), Firestore (에디토리얼 방향/트렌드), dotenv (환경변수)

## Coding Conventions

- JavaScript (ES Modules) - `.js` 확장자 사용, TypeScript 문법 금지
- `import/export` 사용 (CommonJS `require` 금지)
- 비동기 처리는 `async/await` 패턴
- 환경 변수는 `.env.local`에 관리, 코드에 하드코딩 금지

## Environment Variables

`.env.example` 참조. 절대 `.env` 또는 `.env.local` 파일을 커밋하지 않는다.

```
X_API_KEY, X_API_SECRET_KEY, X_ACCESS_TOKEN, X_ACCESS_TOKEN_SECRET
INSTAGRAM_BUSINESS_ACCOUNT_ID, INSTAGRAM_ACCESS_TOKEN
GEMINI_API_KEY, ANTHROPIC_API_KEY, FAL_AI_KEY
```

## Safety Guardrails (필수 준수)

1. **Bot Disclosure:** 모든 게시물에 `(Generated by mystyleKPOP AI)` 자동 삽입
2. **Rate Limiting:** X 자동 게시 시간당 5회, 일일 30회 제한 적용
3. **URL Validation:** Instagram 게시 전 이미지 URL의 공개 접근성 검증
4. **Vibe-Alike:** 아티스트 얼굴 1:1 복제 금지, 분위기만 유사한 가상 모델 사용
5. **Editorial Disclaimer:** AI 창작물/팬아트적 재해석임을 명시

## Common Commands

```bash
npm install          # 의존성 설치
npm start            # 봇 실행 (node src/bot.js)
npm test             # 테스트 (node scripts/test.js)
```

## Key Guidelines References

코드 변경 시 다음 문서의 정책을 반드시 확인:
- `guidelines/legal_compliance.md` - 법률/컴플라이언스
- `guidelines/ip_strategy.md` - IP/초상권 (Vibe-Alike 규칙)
- `guidelines/kpop_expert_guidelines.md` - K-POP 팬덤 문화 맥락
- `docs/automation_plan.md` - 자동화 안전장치 스펙

## Known Issues

None currently.
