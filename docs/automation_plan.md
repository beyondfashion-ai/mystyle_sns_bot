# SNS 자동화 실행 계획 (SNS Automation Plan)

X(Twitter)와 TikTok 게시를 자동화하여 마케팅 효율을 극대화하기 위한 계획입니다.

## 1. 플랫폼별 자동화 기술 분석

### A. X (Twitter)
*   **방식:** Twitter API v2 (공식)
*   **비용 (무료 티어):** 월 500개 게시물 작성 가능 (현재 규모에서 충분)
*   **기술 스택:** `twitter-api-v2` 라이브러리 (Node.js)
*   **구현 난이도:** 낮음 (API 키 발급 후 바로 연동 가능)

### B. Instagram
*   **방식:** Instagram Graph API (공식)
*   **비용:** 무료 (단, Meta 개발자 계정 및 비즈니스 인증 필요)
*   **기술 스택:** Facebook SDK 또는 직접 HTTP 요청 (Axios)
*   **필수 요건:**
    *   Instagram 비즈니스/크리에이터 계정 + 페이스북 페이지 연결.
    *   Meta for Developers 앱 생성 및 `instagram_content_publish` 권한 승인.
*   **구현 특징:**
    1.  미디어 컨테이너 생성 (`POST /{ig-id}/media`)
    2.  처리 대기 (필요시 상태 확인)
    3.  최종 게시 (`POST /{ig-id}/media_publish`)
    *   이미지는 **공개된 외부 URL** 형태여야 함 (Instagram 서버에서 직접 가져감).

### C. TikTok
... (기존 내용 유지)

## 2. API Implementation Details (Node.js)

`src/app/api/sns/post/route.ts` 에서 다음 로직을 통합 관리합니다.

### A. X (Twitter) Logic
*   `twitter-api-v2`를 사용하여 이미지 업로드 및 트윗 게시.
*   최대 4장의 이미지 지원.

### B. Instagram Logic
*   `fetch` (Axios 대용)를 사용하여 Instagram Graph API 호출.
*   **Step 1:** 미디어 컨테이너 생성
    ```http
    POST /v19.0/{ig-user-id}/media?image_url={url}&caption={text}&access_token={token}
    ```
*   **Step 2:** 게시물 배포
    ```http
    POST /v19.0/{ig-user-id}/media_publish?creation_id={container-id}&access_token={token}
    ```

## 3. 안전 및 기술 가이드라인 (Safety & Technical Guardrails)

에이전트 합동 검토 결과에 따라 다음 기술적 제약 사항을 구현에 반영합니다.

### A. 기술적 안전 장치
1.  **X 자동 답장 제한 (Rate Limiting):**
    *   실시간 검색 기반 답장은 **시간당 최대 5회, 일일 30회**로 제한하여 스팸 판정 및 계정 정지 리스크를 차단합니다.
2.  **공통 봇 고지 (Bot Disclosure):**
    *   모든 자동 게시물 하단에 `(Generated by mystyleKPOP AI)` 또는 `[AI 스타일링 영감]` 문구를 자동으로 삽입합니다.
3.  **Instagram 이미지 URL 검증:**
    *   Instagram API는 공개된 URL만 허용하므로, 게시 전 해당 URL이 외부에서 접근 가능한지 체크하는 로직을 추가합니다.

## 4. 실행 전략 (Execution Strategy) - Revised

1.  **1단계: 안전한 아키타이프 구축**
    *   실명 대신 팬덤이 추측할 수 있는 '코드(이모지, 컨셉명)' 위주로 게시물을 구성하여 법적 리스크를 선제적으로 회피합니다.
2.  **2단계: 점진적 자동화 확대**
    *   초기에는 관리자의 승인(Manual Approval)을 거친 게시물만 자동 업로드하고, 안정성이 확인된 후 순수 자동화(Full Auto) 비중을 높입니다.

## 5. 검증 계획 (Verification Plan)

### Automated Verification
*   **Rate Limit Test:** API 호출 시 카운팅 로직이 정상 작동하는지 로그 확인.
*   **Disclosure Check:** 게시물 캡션에 고지 문구가 포함되는지 단위 테스트 수행.

### Manual Verification
1.  관리자 페이지에서 '안전 모드'로 컴백 예측 디자인 게시 시뮬레이션.
2.  X와 인스타그램에서 실명이 아닌 컨셉명으로 자연스럽게 소통되는지 대시보드 모니터링.

---
> [!IMPORTANT]
> **Instagram 이미지 URL 요건:** Instagram API는 **공개된 URL**만 허용합니다. 로컬 개발 환경에서는 `ngrok`을 사용하거나, Firebase Storage의 **Public Download URL**을 전달해야 합니다.

---
> [!WARNING]
> **API 정책 주의:** SNS 플랫폼의 API 정책은 수시로 변경됩니다. 특히 X의 경우 무료 티어의 게시물 수 제한이나 유료화 전환 가능성을 항상 모니터링해야 합니다.
